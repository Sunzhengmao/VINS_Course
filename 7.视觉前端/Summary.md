## 证明题
证明题里用了**拉格朗日乘子法**的思想，最终证明出$λ$最小的特征值就是最终的最小值，其对应的特征向量即为所求
## 特征点法、直接法、光流法
### 特征点
**SIFT：计算慢，费资源，但是效果很好：尺度、方向、光照变化（https://blog.csdn.net/zddblog/article/details/7521424）**

1. 尺度空间极值检测
构建高斯金字塔，使用高斯差分，做近似的二阶（拉普拉斯算子），
根据尺寸分层，在层内，根据σ大小再做高斯并差分，
在3x3x3的邻域中找极值；
2. 关键点定位
需要对极值做进一步的拟合来精确确定关键点的位置和尺度，同时去除低对比度的关键点和不稳定的边缘响应点。
使用二次拟合，如果小于0.5则已收敛到当前像素，否则得挪到相邻像素中去；
DOG算子有较强的边缘响应，因此需要剔除不稳定的边缘响应点
3. 关键点方向分配
直方图统计邻域像素的梯度和方向，找到该特征点的方向；
4. 特征描述
现已知：位置、尺度、方向，现在需建立描述符
根据尺度找邻域；对齐特征点的方向；将邻域内的采样点分配到对应的子区域内；计算每个种子点八个方向的梯度；
归一化处理，去除光照变化的影响；梯度是像素相减得到，因此可以取出灰度整体漂移的情况

**SURF**
等待补充

**ORB（Oriented Brief)**：
1. 给FAST角点添加了尺度和旋转的描述：
尺度不变性由构建图像金字塔，在金字塔的每一层上检测角点来实现；
特征的旋转是由灰度质心法实现
2. 带方向的Brief：
利用FAST的方向，利用方向信息，计算旋转之后的BRIEF

**Harris**
某一个patch中的点在上下、左右移动时变化最大，x和y方向一阶导的平方最大，再写成矩阵的形式，然后把x和y分割开，中间就剩下了二阶导，对二阶导的迹和行列式进行分析，就可以分析出点的坐标



### 特征匹配
1. 解决的数据关联问题，汉明距
2. 最简单的方法：暴力匹配
3. 快速近似最近邻FLANN
### 恢复相机运动
https://zhuanlan.zhihu.com/p/55567702（https://note.youdao.com/ynoteshare1/index.html?id=5e98f487c40ef22f90e1177f29271be5&type=note）

**(1) 2D-2D 对极几何**
- 约束：光心1、光心2、3D点构建极平面，O1O2基线，面面交线为极线，极点等
   $x_2t^{∧}Rx_1=0，p_2^TK^{-T}t^{∧}RK^{-1}p_1=0$，叫做对极约束
- 方法：由DLT从对应点中解出矩阵中的每个值，再对矩阵进行分解，得到R和t

**E矩阵**：$E=t^{∧}R$（相机坐标系下的匹配点的约束关系）

- **来源**：
14讲：
$x_2 = R_{21}x_1+t_{21}$
$t^{∧}x_2=t^{∧}Rx_1$
$x_2^Tt^{∧}x_2 = x_2^Tt^{∧}Rx_1 = 0$
$∴x_2^Tt^{∧}Rx_1 = x_2^TEx_1=0$
- **秩2**：$E=t^{∧}R$，$rand(t^{∧})=2$，所以E秩2；
- **5fod**：E一共6个自由度，尺度等价性；
- 五点法、八点法（多）
- 三角化得到深度来排除剩下3个解
- 强行将E投影到E所在的流形上($Σ→[1,1,0]$)
- 应用场合：基线有一定距离
  
**F矩阵**：F=K-T E K-1（匹配点像素坐标的约束关系）
- **来源**
由E矩阵，加入左右两帧的内参，得到F矩阵
F=K-T E K-1
- **秩2**->还是由于t^的秩2
- **7fod**->F一共9个参数（内参4x2+R3+t3=14>9），
- 尺度等价性；
- def(F)=0；

**H矩阵**：H=K(R - tnT/d)K-1（描述了两个平面之间的映射关系）

- **来源**：
nTP+d=0
-nTP/d=1
p2=K(RP+t)
    =K(RP+t(-nTP/d))
    =K(R - tnT/d)P
    =K(R - tnT/d)K-1p1
∴H=K(R - tnT/d)K-1
- 秩3
- 8DOF：尺度
- 判断方法：用深度来排除2组解，
- 适用场合：纯旋转、特征点共面
- 求解方法
我觉得直接看那个链接就好了，两个一起起作用，这里就不再详解了
排除解的方法

**(2) 3D-2D PNP**：

**EPNP解法**:
- 主要思路：将像素的2D坐标转为相机坐标系下的3D坐标，再和世界坐标系下的3D坐标做3D-3D点云配准，得到3D到2D的外参Rt
根本思想：利用刚体结构不变性，也就是说世界坐标系下的点点相对关系和同样的点在相机坐标系下的点点相对关系是一样的，构建约束；再结合成像模型构建第二个约束
- 主要的方法：
①寻找世界坐标系下的控制点，并求出每个点相对于控制点的坐标（3维->4维）
②将相机坐标系下的控制点坐标当作未知数，利用相机投影模型和刚体结构不变性做约束，进行求解；
③可以选用N=1,2,3,4对零空间的向量进行组合，求β；
④最后通过相机系下的3D距离=世界系下的3D距离，构建残差方程，优化β；
⑤得到相机系下的控制点后计算出每个3D点，最后使用ICP方法求解R和t

**(3) 3D-3D ICP**
请看点云中的ICP环节

### 光流法
1. 主要方法：
保留特征点，但是用光流法跟踪来代替描述子匹配，最后还是用ICP、PnP、对极几何来估计运动；
都是基于梯度信息，听图像梯度的指示
2. 两种假设：
**灰度不变假设**：I(x+dx,y+dy,t+dt)=I(x,y,t)
**同向小运动假设**：图像中某个窗口内的像素具有相同的运动；（不能出现图像的旋转等情况）
3. 两种方法：
- Lk光流，对x、y、t求导，一阶泰勒展开后两者相等；
对窗口中的像素做Ax=-b的计算，得到像素在图像间的运动速度u和v，
- 使用优化的思想，前后像素值x、y相减作为残差，Δx和Δy作为待优化的值，最后确定新的x和y，
可以使用单层光流，和多层光流。
- 多层光流涉及从粗到精的问题，粗的肯定可以得到好的初始解，然后根据粗的层的解当作下一层的初始解，继续做优化，也就		
是以粗层解为可行解，迭代寻找最优解的过程

### 直接法
1. 区别：
光流法是先找运动后的匹配（未用到相机本身的几何结构），再用匹配点求位姿使重投影误差最小；
直接法直接基于相机模型优化位姿使上一帧图像和当前帧图像的光度误差最小，相当于一个是先找x维最优再找y维最优，一个是直接对xy一起找最优
2. 假设：
灰度不变假设：同一空间三维点在各个视角下的灰度值都不变
3. 明显缺点：
图像非凸，只能找到局部最小值；
灰度不变假设太强了
4. 像素灰度引导着优化的方向，只需有像素梯度，而不需要有角点